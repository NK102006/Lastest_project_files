<!DOCTYPE html>
<html>
<head>
    <title>üîê Smart Attendance Login</title>
    <meta charset="UTF-8">

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <style>
        *{
            margin:0;
            padding:0;
            box-sizing:border-box;
        }

        body{
            font-family:'Segoe UI', Arial, sans-serif;

            /* animated gradient background */
            background: linear-gradient(-45deg,#667eea,#764ba2,#f093fb,#f5576c);
            background-size:400% 400%;
            animation: gradientShift 15s ease infinite;

            min-height:100vh;
            display:flex;
            align-items:center;
            justify-content:center;
        }

        @keyframes gradientShift{
            0%{background-position:0% 50%;}
            50%{background-position:100% 50%;}
            100%{background-position:0% 50%;}
        }

        /* ---------- CARD ---------- */
        .login-card{
            background:white;
            padding:2rem;
            border-radius:20px;
            box-shadow:0 20px 40px rgba(0,0,0,0.12);
            width:100%;
            max-width:400px;
            position:relative;
        }

        h2{
            text-align:center;
            color:#333;
            margin-bottom:1.5rem;
        }

        /* ---------- INPUT ---------- */
        input{
            width:100%;
            padding:15px;
            border:2px solid #e1e5e9;
            border-radius:12px;
            font-size:16px;
            margin-bottom:1rem;
            transition:all .3s ease;
        }

        input:focus{
            outline:none;
            border-color:#8747c7;
        }

        /* ---------- BUTTON ---------- */
        #sendBtn{
            width:100%;
            padding:15px;
            background:linear-gradient(135deg,#8747c7,#3d1764);
            color:white;
            border:none;
            border-radius:12px;
            font-size:16px;
            cursor:pointer;

            position:relative;
            overflow:hidden;
        }

        /* Shine layer */
        .shine{
            position:absolute;
            top:0;
            left:-150%;
            width:60%;
            height:100%;
            background:linear-gradient(
                120deg,
                transparent,
                rgba(255,255,255,0.35),
                transparent
            );
            transform:skewX(-25deg);
            pointer-events:none;
        }

        button:disabled{
            opacity:.6;
            cursor:not-allowed;
        }

        /* ---------- MESSAGE ---------- */
        .message{
            padding:12px;
            border-radius:8px;
            margin:1rem 0;
            font-weight:500;
        }

        .error{
            background:#fee;
            color:#c33;
            border-left:4px solid #c33;
        }

        .success{
            background:#efe;
            color:#272;
            border-left:4px solid #272;
        }
    </style>
</head>

<body>

<div class="login-card">
    <h2>üöÄ Smart Webcam</h2>

    <form id="loginForm">
        <input type="email" id="email" name="email" placeholder="üìß Enter your email" required>

        <button type="submit" id="sendBtn">
            <span class="shine"></span>
            üì§ Send OTP
        </button>
    </form>

    <div id="message"></div>
</div>


<script>
/* ==============================
   FORM LOGIC
============================== */
document.getElementById('loginForm').onsubmit = async (e) => {

    e.preventDefault();

    const formData = new FormData(e.target);
    const email = document.getElementById('email').value.trim();
    const btn = document.getElementById('sendBtn');

    if(!email || !email.includes('@')){
        showMessage('‚ùå Please enter a valid email!', 'error');
        return;
    }

    btn.textContent = "‚è≥ Sending...";
    btn.disabled = true;

    try{
        const response = await fetch('/send-otp',{
            method:'POST',
            body:formData
        });

        const data = await response.json();
        showMessage(data.message, data.success ? 'success' : 'error');

        if(data.success && data.redirect){
            setTimeout(()=>{
                window.location.href = data.redirect;
            },1000);
        }

    }catch{
        showMessage('‚ùå Network error! Please try again.','error');
    }

    btn.innerHTML = `<span class="shine"></span> üì§ Send OTP`;
    btn.disabled = false;
};


/* ==============================
   MESSAGE ANIMATION
============================== */
function showMessage(text,type){
    const msgDiv = document.getElementById('message');
    msgDiv.innerHTML = `<div class="message ${type}">${text}</div>`;

    gsap.from(".message",{
        y:10,
        opacity:0,
        scale:.9,
        duration:.4,
        ease:"back.out(2)"
    });
}


/* ==============================
   UI INTERACTIONS (GSAP)
============================== */

window.addEventListener("load",()=>{

    /* Card entrance */
    gsap.from(".login-card",{
        y:80,
        opacity:0,
        scale:.9,
        duration:1,
        ease:"power3.out"
    });
});


/* Input focus animation */
document.querySelectorAll("input").forEach(input=>{

    input.addEventListener("focus",()=>{
        gsap.to(input,{
            y:-3,
            scale:1.02,
            boxShadow:"0 8px 20px rgba(135,71,199,0.25)",
            duration:.25
        });
    });

    input.addEventListener("blur",()=>{
        gsap.to(input,{
            y:0,
            scale:1,
            boxShadow:"0 0 0 rgba(0,0,0,0)",
            duration:.25
        });
    });

});


/* Button interactions */
const btn = document.getElementById("sendBtn");
const shine = document.querySelector(".shine");

/* hover lift */
btn.addEventListener("mouseenter",()=>{
    gsap.to(btn,{
        y:-4,
        scale:1.03,
        boxShadow:"0 12px 25px rgba(61,23,100,0.35)",
        duration:.25
    });

    /* shine sweep */
    gsap.fromTo(shine,
        { left:"-150%" },
        { left:"150%", duration:1.2, ease:"power2.out" }
    );
});

/* hover leave */
btn.addEventListener("mouseleave",()=>{
    gsap.to(btn,{
        y:0,
        scale:1,
        boxShadow:"0 0 0 rgba(0,0,0,0)",
        duration:.25
    });
});

/* press click */
btn.addEventListener("mousedown",()=>{
    gsap.to(btn,{ scale:.96, duration:.1 });
});

btn.addEventListener("mouseup",()=>{
    gsap.to(btn,{ scale:1.03, duration:.1 });
});

</script>

</body>
</html>
